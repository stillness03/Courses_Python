{% extends "admin_panel/base.html" %}
{% block title %}Question Detail{% endblock %}

{% block content %}
<div class="d-flex justify-content-between align-items-center mb-4">
  <h2>Question: <span id="question-text"></span></h2>
  <div>
    <button class="btn btn-success" data-bs-toggle="modal" data-bs-target="#createAnswerModal">+ Add Answer</button>
    <a href="javascript:history.back()" class="btn btn-secondary">‚Üê Back</a>
  </div>
</div>

<!-- Modal Create Answer -->
<div class="modal fade" id="createAnswerModal" tabindex="-1">
  <div class="modal-dialog">
    <form id="answerForm" class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Create Answer</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
      </div>
      <div class="modal-body">
        <div class="mb-3">
          <label class="form-label">Answer Text</label>
          <input type="text" id="answerText" class="form-control" required>
        </div>
        <div class="mb-3">
          <label class="form-label">Correct?</label>
          <select id="isCorrect" class="form-control">
            <option value="false">No</option>
            <option value="true">Yes</option>
          </select>
        </div>
      </div>
      <div class="modal-footer">
        <button type="submit" class="btn btn-success">Save</button>
      </div>
    </form>
  </div>
</div>

<script>
let questionId = window.location.pathname.split("/").filter(Boolean).pop();

document.getElementById("answerForm").addEventListener("submit", e => {
  e.preventDefault();
  fetch("/api/answers/", {
    method: "POST",
    headers: {"Content-Type": "application/json"},
    body: JSON.stringify({
      question: questionId,
      text: document.getElementById("answerText").value,
      is_correct: document.getElementById("isCorrect").value === "true"
    })
  }).then(() => {
    location.reload();
  });
});
</script>
{% endblock %}
